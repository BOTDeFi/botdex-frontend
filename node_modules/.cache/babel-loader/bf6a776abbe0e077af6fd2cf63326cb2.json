{"ast":null,"code":"var _jsxFileName = \"/Users/rocknblock/Documents/GitHub/strong-hands-frontend/src/components/sections/Dao/DaoWrapperContent/index.tsx\",\n    _s = $RefreshSig$();\n\nimport React from 'react';\nimport BigNumber from 'bignumber.js/bignumber';\nimport classNames from 'classnames';\nimport { observer } from 'mobx-react-lite';\nimport { Skeleton } from '@/components/atoms';\nimport { SkeletonSixRows, SkeletonTenRows, SkeletonTwoRows } from '@/components/atoms/Skeleton';\nimport ReactMarkdown from '@/components/molecules/ReactMarkdown';\nimport { DaoInformation, DaoSection } from '@/components/sections/Dao';\nimport DaoProposalCastVote from '@/components/sections/Dao/DaoProposalCastVote';\nimport DaoProposalInformation from '@/components/sections/Dao/DaoProposalInformation';\nimport DaoProposalVotes from '@/components/sections/Dao/DaoProposalVotes';\nimport DaoProposalVotesResult from '@/components/sections/Dao/DaoProposalVotesResult';\nimport { tokens } from '@/config/tokens';\nimport { useProposalVotes } from '@/hooks/dao/useProposalVotes';\nimport { useMst } from '@/store';\nimport { BIG_ZERO } from '@/utils/constants';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst DaoWrapperContentSkeleton = /*#__PURE__*/React.memo(_c = () => {\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"dao__title text-black text-bold\",\n      children: /*#__PURE__*/_jsxDEV(Skeleton, {\n        active: true,\n        title: true,\n        paragraph: false\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 28,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 27,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"section\", {\n      className: \"section document dao__section box-shadow box-white\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"document__wrapper\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"document__column\",\n          children: /*#__PURE__*/_jsxDEV(SkeletonTenRows, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 33,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 32,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"document__column information-column text-ssm\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: classNames('document__status', 'btn', 'btn-ssm', 'text-ssmd'),\n            children: /*#__PURE__*/_jsxDEV(Skeleton, {\n              active: true,\n              title: true,\n              paragraph: false\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 37,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 36,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(DaoInformation, {\n            className: \"document__information\",\n            title: \"Information\",\n            children: /*#__PURE__*/_jsxDEV(SkeletonSixRows, {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 40,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 39,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(DaoInformation, {\n            className: \"document__information\",\n            title: \"Current results\",\n            children: /*#__PURE__*/_jsxDEV(SkeletonTwoRows, {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 44,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 43,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 35,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 31,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 30,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(DaoSection, {\n      className: \"dao__section\",\n      title: \"Cast your vote\",\n      children: /*#__PURE__*/_jsxDEV(SkeletonTwoRows, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 51,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 50,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(DaoSection, {\n      className: \"dao__section\",\n      title: \"Votes\",\n      children: /*#__PURE__*/_jsxDEV(SkeletonTenRows, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 55,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 54,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true);\n});\n_c2 = DaoWrapperContentSkeleton;\n\nconst getPercents = (amount, totalAmount) => {\n  const percents = amount.div(totalAmount).multipliedBy(100);\n  const percentsRounded = percents.toFixed(2);\n  return {\n    percents,\n    percentsRounded\n  };\n};\n\nconst DaoWrapperContent = observer(_c3 = _s(({\n  proposal\n}) => {\n  _s();\n\n  const {\n    votes: votesRaw,\n    votingPowersLoading,\n    updateProposalVotes\n  } = useProposalVotes(proposal === null || proposal === void 0 ? void 0 : proposal.id);\n  const {\n    user\n  } = useMst();\n  if (!proposal) return /*#__PURE__*/_jsxDEV(DaoWrapperContentSkeleton, {}, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 73,\n    columnNumber: 25\n  }, this);\n  const {\n    id: proposalId,\n    ipfs,\n    title,\n    author,\n    body,\n    choices,\n    start,\n    end,\n    snapshot,\n    state: status,\n    type: votingSystem\n  } = proposal;\n  let totalChoicesVotingPower = BIG_ZERO;\n  const mapChoiceToTotalVotingPower = votesRaw.reduce((acc, {\n    choice: choiceIndex,\n    votingPower\n  }) => {\n    const choice = choices[choiceIndex - 1];\n    const totalVotingPower = acc[choice] ? new BigNumber(acc[choice].votingPower) : BIG_ZERO;\n    acc[choice] = {\n      votingPower: totalVotingPower.plus(votingPower)\n    };\n    totalChoicesVotingPower = totalChoicesVotingPower.plus(votingPower);\n    return acc;\n  }, {});\n  const results = votesRaw.length ? choices.map(choice => {\n    const {\n      votingPower\n    } = mapChoiceToTotalVotingPower[choice] || {\n      votingPower: BIG_ZERO\n    };\n    return {\n      choice,\n      votingPower,\n      percents: getPercents(votingPower, totalChoicesVotingPower).percentsRounded\n    };\n  }) : [];\n  const votes = votesRaw.map(({\n    id: voteId,\n    voter,\n    choice: choiceIndex,\n    votingPower\n  }) => {\n    return {\n      voteId,\n      person: {\n        address: voter\n      },\n      choice: choices[choiceIndex - 1],\n      votingPower\n    };\n  });\n  const hasConnectedWallet = Boolean(user.address);\n  const hasAlreadyVoted = votesRaw.some(({\n    voter\n  }) => voter === user.address);\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"dao__title text-black text-bold\",\n      children: title\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 131,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"section\", {\n      className: \"section document dao__section box-shadow box-white\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"document__wrapper\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"document__column\",\n          children: /*#__PURE__*/_jsxDEV(ReactMarkdown, {\n            className: \"document__text text-black\",\n            children: body\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 135,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 134,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"document__column information-column text-ssm\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: classNames('document__status', `document__status_${status}`, 'btn', 'btn-ssm', 'text-ssmd'),\n            children: status\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 138,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(DaoInformation, {\n            className: \"document__information\",\n            title: \"Information\",\n            children: /*#__PURE__*/_jsxDEV(DaoProposalInformation, {\n              ipfs: ipfs,\n              author: author,\n              start: start,\n              end: end,\n              snapshot: snapshot,\n              votingSystem: votingSystem\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 150,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 149,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(DaoInformation, {\n            className: \"document__information\",\n            title: \"Current results\",\n            children: /*#__PURE__*/_jsxDEV(SkeletonTwoRows, {\n              loading: votingPowersLoading,\n              children: /*#__PURE__*/_jsxDEV(DaoProposalVotesResult, {\n                results: results\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 162,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 161,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 160,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 137,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 133,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 132,\n      columnNumber: 7\n    }, this), status === 'active' && hasConnectedWallet && !hasAlreadyVoted && /*#__PURE__*/_jsxDEV(DaoSection, {\n      className: \"dao__section\",\n      title: \"Cast your vote\",\n      children: /*#__PURE__*/_jsxDEV(SkeletonTwoRows, {\n        loading: votingPowersLoading,\n        children: /*#__PURE__*/_jsxDEV(DaoProposalCastVote, {\n          proposalId: proposalId,\n          choices: choices,\n          onVote: updateProposalVotes\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 172,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 171,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 170,\n      columnNumber: 9\n    }, this), status !== 'pending' && /*#__PURE__*/_jsxDEV(DaoSection, {\n      className: \"dao__section\",\n      title: \"Votes\",\n      children: /*#__PURE__*/_jsxDEV(SkeletonTenRows, {\n        loading: votingPowersLoading,\n        children: /*#__PURE__*/_jsxDEV(DaoProposalVotes, {\n          votes: votes,\n          token: tokens.rp1\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 184,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 183,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 182,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true);\n}, \"kSqhkz50xLVfViDTg2GNcqb8lcY=\", false, function () {\n  return [useProposalVotes, useMst];\n}));\n_c4 = DaoWrapperContent;\nexport default DaoWrapperContent;\n\nvar _c, _c2, _c3, _c4;\n\n$RefreshReg$(_c, \"DaoWrapperContentSkeleton$React.memo\");\n$RefreshReg$(_c2, \"DaoWrapperContentSkeleton\");\n$RefreshReg$(_c3, \"DaoWrapperContent$observer\");\n$RefreshReg$(_c4, \"DaoWrapperContent\");","map":{"version":3,"sources":["/Users/rocknblock/Documents/GitHub/strong-hands-frontend/src/components/sections/Dao/DaoWrapperContent/index.tsx"],"names":["React","BigNumber","classNames","observer","Skeleton","SkeletonSixRows","SkeletonTenRows","SkeletonTwoRows","ReactMarkdown","DaoInformation","DaoSection","DaoProposalCastVote","DaoProposalInformation","DaoProposalVotes","DaoProposalVotesResult","tokens","useProposalVotes","useMst","BIG_ZERO","DaoWrapperContentSkeleton","memo","getPercents","amount","totalAmount","percents","div","multipliedBy","percentsRounded","toFixed","DaoWrapperContent","proposal","votes","votesRaw","votingPowersLoading","updateProposalVotes","id","user","proposalId","ipfs","title","author","body","choices","start","end","snapshot","state","status","type","votingSystem","totalChoicesVotingPower","mapChoiceToTotalVotingPower","reduce","acc","choice","choiceIndex","votingPower","totalVotingPower","plus","results","length","map","voteId","voter","person","address","hasConnectedWallet","Boolean","hasAlreadyVoted","some","rp1"],"mappings":";;;AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,OAAOC,SAAP,MAAsB,wBAAtB;AACA,OAAOC,UAAP,MAAuB,YAAvB;AACA,SAASC,QAAT,QAAyB,iBAAzB;AAEA,SAASC,QAAT,QAAyB,oBAAzB;AACA,SAASC,eAAT,EAA0BC,eAA1B,EAA2CC,eAA3C,QAAkE,6BAAlE;AACA,OAAOC,aAAP,MAA0B,sCAA1B;AACA,SAASC,cAAT,EAAyBC,UAAzB,QAA2C,2BAA3C;AACA,OAAOC,mBAAP,MAAgC,+CAAhC;AACA,OAAOC,sBAAP,MAAmC,kDAAnC;AACA,OAAOC,gBAAP,MAAwC,4CAAxC;AACA,OAAOC,sBAAP,MAAmC,kDAAnC;AACA,SAASC,MAAT,QAAuB,iBAAvB;AACA,SAASC,gBAAT,QAAiC,8BAAjC;AAEA,SAASC,MAAT,QAAuB,SAAvB;AACA,SAASC,QAAT,QAAyB,mBAAzB;;;AAMA,MAAMC,yBAAmC,gBAAGnB,KAAK,CAACoB,IAAN,MAAW,MAAM;AAC3D,sBACE;AAAA,4BACE;AAAK,MAAA,SAAS,EAAC,iCAAf;AAAA,6BACE,QAAC,QAAD;AAAU,QAAA,MAAM,MAAhB;AAAiB,QAAA,KAAK,MAAtB;AAAuB,QAAA,SAAS,EAAE;AAAlC;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,YADF,eAIE;AAAS,MAAA,SAAS,EAAC,oDAAnB;AAAA,6BACE;AAAK,QAAA,SAAS,EAAC,mBAAf;AAAA,gCACE;AAAK,UAAA,SAAS,EAAC,kBAAf;AAAA,iCACE,QAAC,eAAD;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,gBADF,eAIE;AAAK,UAAA,SAAS,EAAC,8CAAf;AAAA,kCACE;AAAK,YAAA,SAAS,EAAElB,UAAU,CAAC,kBAAD,EAAqB,KAArB,EAA4B,SAA5B,EAAuC,WAAvC,CAA1B;AAAA,mCACE,QAAC,QAAD;AAAU,cAAA,MAAM,MAAhB;AAAiB,cAAA,KAAK,MAAtB;AAAuB,cAAA,SAAS,EAAE;AAAlC;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,kBADF,eAIE,QAAC,cAAD;AAAgB,YAAA,SAAS,EAAC,uBAA1B;AAAkD,YAAA,KAAK,EAAC,aAAxD;AAAA,mCACE,QAAC,eAAD;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,kBAJF,eAQE,QAAC,cAAD;AAAgB,YAAA,SAAS,EAAC,uBAA1B;AAAkD,YAAA,KAAK,EAAC,iBAAxD;AAAA,mCACE,QAAC,eAAD;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,kBARF;AAAA;AAAA;AAAA;AAAA;AAAA,gBAJF;AAAA;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,YAJF,eAwBE,QAAC,UAAD;AAAY,MAAA,SAAS,EAAC,cAAtB;AAAqC,MAAA,KAAK,EAAC,gBAA3C;AAAA,6BACE,QAAC,eAAD;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,YAxBF,eA4BE,QAAC,UAAD;AAAY,MAAA,SAAS,EAAC,cAAtB;AAAqC,MAAA,KAAK,EAAC,OAA3C;AAAA,6BACE,QAAC,eAAD;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,YA5BF;AAAA,kBADF;AAkCD,CAnC2C,CAA5C;MAAMiB,yB;;AAqCN,MAAME,WAAW,GAAG,CAACC,MAAD,EAAoBC,WAApB,KAA+C;AACjE,QAAMC,QAAQ,GAAGF,MAAM,CAACG,GAAP,CAAWF,WAAX,EAAwBG,YAAxB,CAAqC,GAArC,CAAjB;AACA,QAAMC,eAAe,GAAGH,QAAQ,CAACI,OAAT,CAAiB,CAAjB,CAAxB;AACA,SAAO;AAAEJ,IAAAA,QAAF;AAAYG,IAAAA;AAAZ,GAAP;AACD,CAJD;;AAMA,MAAME,iBAAoD,GAAG1B,QAAQ,UAAC,CAAC;AAAE2B,EAAAA;AAAF,CAAD,KAAkB;AAAA;;AACtF,QAAM;AAAEC,IAAAA,KAAK,EAAEC,QAAT;AAAmBC,IAAAA,mBAAnB;AAAwCC,IAAAA;AAAxC,MAAgElB,gBAAgB,CACpFc,QADoF,aACpFA,QADoF,uBACpFA,QAAQ,CAAEK,EAD0E,CAAtF;AAGA,QAAM;AAAEC,IAAAA;AAAF,MAAWnB,MAAM,EAAvB;AAEA,MAAI,CAACa,QAAL,EAAe,oBAAO,QAAC,yBAAD;AAAA;AAAA;AAAA;AAAA,UAAP;AAEf,QAAM;AACJK,IAAAA,EAAE,EAAEE,UADA;AAEJC,IAAAA,IAFI;AAGJC,IAAAA,KAHI;AAIJC,IAAAA,MAJI;AAKJC,IAAAA,IALI;AAMJC,IAAAA,OANI;AAOJC,IAAAA,KAPI;AAQJC,IAAAA,GARI;AASJC,IAAAA,QATI;AAUJC,IAAAA,KAAK,EAAEC,MAVH;AAWJC,IAAAA,IAAI,EAAEC;AAXF,MAYFnB,QAZJ;AAcA,MAAIoB,uBAAuB,GAAGhC,QAA9B;AAEA,QAAMiC,2BAA2B,GAAGnB,QAAQ,CAACoB,MAAT,CAClC,CAACC,GAAD,EAAM;AAAEC,IAAAA,MAAM,EAAEC,WAAV;AAAuBC,IAAAA;AAAvB,GAAN,KAA+C;AAC7C,UAAMF,MAAM,GAAGZ,OAAO,CAACa,WAAW,GAAG,CAAf,CAAtB;AACA,UAAME,gBAAgB,GAAGJ,GAAG,CAACC,MAAD,CAAH,GAAc,IAAIrD,SAAJ,CAAcoD,GAAG,CAACC,MAAD,CAAH,CAAYE,WAA1B,CAAd,GAAuDtC,QAAhF;AACAmC,IAAAA,GAAG,CAACC,MAAD,CAAH,GAAc;AACZE,MAAAA,WAAW,EAAEC,gBAAgB,CAACC,IAAjB,CAAsBF,WAAtB;AADD,KAAd;AAGAN,IAAAA,uBAAuB,GAAGA,uBAAuB,CAACQ,IAAxB,CAA6BF,WAA7B,CAA1B;AACA,WAAOH,GAAP;AACD,GATiC,EAUlC,EAVkC,CAApC;AAaA,QAAMM,OAAO,GAAG3B,QAAQ,CAAC4B,MAAT,GACZlB,OAAO,CAACmB,GAAR,CAAaP,MAAD,IAAY;AACtB,UAAM;AAAEE,MAAAA;AAAF,QAAkBL,2BAA2B,CAACG,MAAD,CAA3B,IAAuC;AAAEE,MAAAA,WAAW,EAAEtC;AAAf,KAA/D;AACA,WAAO;AACLoC,MAAAA,MADK;AAELE,MAAAA,WAFK;AAGLhC,MAAAA,QAAQ,EAAEH,WAAW,CAACmC,WAAD,EAAcN,uBAAd,CAAX,CAAkDvB;AAHvD,KAAP;AAKD,GAPD,CADY,GASZ,EATJ;AAWA,QAAMI,KAAK,GAAGC,QAAQ,CAAC6B,GAAT,CAAa,CAAC;AAAE1B,IAAAA,EAAE,EAAE2B,MAAN;AAAcC,IAAAA,KAAd;AAAqBT,IAAAA,MAAM,EAAEC,WAA7B;AAA0CC,IAAAA;AAA1C,GAAD,KAA6D;AACtF,WAAO;AACLM,MAAAA,MADK;AAELE,MAAAA,MAAM,EAAE;AACNC,QAAAA,OAAO,EAAEF;AADH,OAFH;AAKLT,MAAAA,MAAM,EAAEZ,OAAO,CAACa,WAAW,GAAG,CAAf,CALV;AAMLC,MAAAA;AANK,KAAP;AAQD,GATa,CAAd;AAWA,QAAMU,kBAAkB,GAAGC,OAAO,CAAC/B,IAAI,CAAC6B,OAAN,CAAlC;AACA,QAAMG,eAAe,GAAGpC,QAAQ,CAACqC,IAAT,CAAc,CAAC;AAAEN,IAAAA;AAAF,GAAD,KAAeA,KAAK,KAAK3B,IAAI,CAAC6B,OAA5C,CAAxB;AAEA,sBACE;AAAA,4BACE;AAAK,MAAA,SAAS,EAAC,iCAAf;AAAA,gBAAkD1B;AAAlD;AAAA;AAAA;AAAA;AAAA,YADF,eAEE;AAAS,MAAA,SAAS,EAAC,oDAAnB;AAAA,6BACE;AAAK,QAAA,SAAS,EAAC,mBAAf;AAAA,gCACE;AAAK,UAAA,SAAS,EAAC,kBAAf;AAAA,iCACE,QAAC,aAAD;AAAe,YAAA,SAAS,EAAC,2BAAzB;AAAA,sBAAsDE;AAAtD;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,gBADF,eAIE;AAAK,UAAA,SAAS,EAAC,8CAAf;AAAA,kCACE;AACE,YAAA,SAAS,EAAEvC,UAAU,CACnB,kBADmB,EAElB,oBAAmB6C,MAAO,EAFR,EAGnB,KAHmB,EAInB,SAJmB,EAKnB,WALmB,CADvB;AAAA,sBASGA;AATH;AAAA;AAAA;AAAA;AAAA,kBADF,eAYE,QAAC,cAAD;AAAgB,YAAA,SAAS,EAAC,uBAA1B;AAAkD,YAAA,KAAK,EAAC,aAAxD;AAAA,mCACE,QAAC,sBAAD;AACE,cAAA,IAAI,EAAET,IADR;AAEE,cAAA,MAAM,EAAEE,MAFV;AAGE,cAAA,KAAK,EAAEG,KAHT;AAIE,cAAA,GAAG,EAAEC,GAJP;AAKE,cAAA,QAAQ,EAAEC,QALZ;AAME,cAAA,YAAY,EAAEI;AANhB;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,kBAZF,eAuBE,QAAC,cAAD;AAAgB,YAAA,SAAS,EAAC,uBAA1B;AAAkD,YAAA,KAAK,EAAC,iBAAxD;AAAA,mCACE,QAAC,eAAD;AAAiB,cAAA,OAAO,EAAEhB,mBAA1B;AAAA,qCACE,QAAC,sBAAD;AAAwB,gBAAA,OAAO,EAAE0B;AAAjC;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,kBAvBF;AAAA;AAAA;AAAA;AAAA;AAAA,gBAJF;AAAA;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,YAFF,EAuCGZ,MAAM,KAAK,QAAX,IAAuBmB,kBAAvB,IAA6C,CAACE,eAA9C,iBACC,QAAC,UAAD;AAAY,MAAA,SAAS,EAAC,cAAtB;AAAqC,MAAA,KAAK,EAAC,gBAA3C;AAAA,6BACE,QAAC,eAAD;AAAiB,QAAA,OAAO,EAAEnC,mBAA1B;AAAA,+BACE,QAAC,mBAAD;AACE,UAAA,UAAU,EAAEI,UADd;AAEE,UAAA,OAAO,EAAEK,OAFX;AAGE,UAAA,MAAM,EAAER;AAHV;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,YAxCJ,EAmDGa,MAAM,KAAK,SAAX,iBACC,QAAC,UAAD;AAAY,MAAA,SAAS,EAAC,cAAtB;AAAqC,MAAA,KAAK,EAAC,OAA3C;AAAA,6BACE,QAAC,eAAD;AAAiB,QAAA,OAAO,EAAEd,mBAA1B;AAAA,+BACE,QAAC,gBAAD;AAAkB,UAAA,KAAK,EAAEF,KAAzB;AAAgC,UAAA,KAAK,EAAEhB,MAAM,CAACuD;AAA9C;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,YApDJ;AAAA,kBADF;AA6DD,CA3HoE;AAAA,UACGtD,gBADH,EAIlDC,MAJkD;AAAA,GAArE;MAAMY,iB;AA6HN,eAAeA,iBAAf","sourcesContent":["import React from 'react';\nimport BigNumber from 'bignumber.js/bignumber';\nimport classNames from 'classnames';\nimport { observer } from 'mobx-react-lite';\n\nimport { Skeleton } from '@/components/atoms';\nimport { SkeletonSixRows, SkeletonTenRows, SkeletonTwoRows } from '@/components/atoms/Skeleton';\nimport ReactMarkdown from '@/components/molecules/ReactMarkdown';\nimport { DaoInformation, DaoSection } from '@/components/sections/Dao';\nimport DaoProposalCastVote from '@/components/sections/Dao/DaoProposalCastVote';\nimport DaoProposalInformation from '@/components/sections/Dao/DaoProposalInformation';\nimport DaoProposalVotes, { IVote } from '@/components/sections/Dao/DaoProposalVotes';\nimport DaoProposalVotesResult from '@/components/sections/Dao/DaoProposalVotesResult';\nimport { tokens } from '@/config/tokens';\nimport { useProposalVotes } from '@/hooks/dao/useProposalVotes';\nimport { IProposal } from '@/services/api/snapshot.org/hooks';\nimport { useMst } from '@/store';\nimport { BIG_ZERO } from '@/utils/constants';\n\ninterface IDaoWrapperContentProps {\n  proposal?: IProposal;\n}\n\nconst DaoWrapperContentSkeleton: React.FC = React.memo(() => {\n  return (\n    <>\n      <div className=\"dao__title text-black text-bold\">\n        <Skeleton active title paragraph={false} />\n      </div>\n      <section className=\"section document dao__section box-shadow box-white\">\n        <div className=\"document__wrapper\">\n          <div className=\"document__column\">\n            <SkeletonTenRows />\n          </div>\n          <div className=\"document__column information-column text-ssm\">\n            <div className={classNames('document__status', 'btn', 'btn-ssm', 'text-ssmd')}>\n              <Skeleton active title paragraph={false} />\n            </div>\n            <DaoInformation className=\"document__information\" title=\"Information\">\n              <SkeletonSixRows />\n            </DaoInformation>\n\n            <DaoInformation className=\"document__information\" title=\"Current results\">\n              <SkeletonTwoRows />\n            </DaoInformation>\n          </div>\n        </div>\n      </section>\n\n      <DaoSection className=\"dao__section\" title=\"Cast your vote\">\n        <SkeletonTwoRows />\n      </DaoSection>\n\n      <DaoSection className=\"dao__section\" title=\"Votes\">\n        <SkeletonTenRows />\n      </DaoSection>\n    </>\n  );\n});\n\nconst getPercents = (amount: BigNumber, totalAmount: BigNumber) => {\n  const percents = amount.div(totalAmount).multipliedBy(100);\n  const percentsRounded = percents.toFixed(2);\n  return { percents, percentsRounded };\n};\n\nconst DaoWrapperContent: React.FC<IDaoWrapperContentProps> = observer(({ proposal }) => {\n  const { votes: votesRaw, votingPowersLoading, updateProposalVotes } = useProposalVotes(\n    proposal?.id,\n  );\n  const { user } = useMst();\n\n  if (!proposal) return <DaoWrapperContentSkeleton />;\n\n  const {\n    id: proposalId,\n    ipfs,\n    title,\n    author,\n    body,\n    choices,\n    start,\n    end,\n    snapshot,\n    state: status,\n    type: votingSystem,\n  } = proposal;\n\n  let totalChoicesVotingPower = BIG_ZERO;\n\n  const mapChoiceToTotalVotingPower = votesRaw.reduce(\n    (acc, { choice: choiceIndex, votingPower }) => {\n      const choice = choices[choiceIndex - 1];\n      const totalVotingPower = acc[choice] ? new BigNumber(acc[choice].votingPower) : BIG_ZERO;\n      acc[choice] = {\n        votingPower: totalVotingPower.plus(votingPower),\n      };\n      totalChoicesVotingPower = totalChoicesVotingPower.plus(votingPower);\n      return acc;\n    },\n    {} as Record<string, { votingPower: BigNumber }>,\n  );\n\n  const results = votesRaw.length\n    ? choices.map((choice) => {\n        const { votingPower } = mapChoiceToTotalVotingPower[choice] || { votingPower: BIG_ZERO };\n        return {\n          choice,\n          votingPower,\n          percents: getPercents(votingPower, totalChoicesVotingPower).percentsRounded,\n        };\n      })\n    : [];\n\n  const votes = votesRaw.map(({ id: voteId, voter, choice: choiceIndex, votingPower }) => {\n    return {\n      voteId,\n      person: {\n        address: voter,\n      },\n      choice: choices[choiceIndex - 1],\n      votingPower,\n    } as IVote;\n  });\n\n  const hasConnectedWallet = Boolean(user.address);\n  const hasAlreadyVoted = votesRaw.some(({ voter }) => voter === user.address);\n\n  return (\n    <>\n      <div className=\"dao__title text-black text-bold\">{title}</div>\n      <section className=\"section document dao__section box-shadow box-white\">\n        <div className=\"document__wrapper\">\n          <div className=\"document__column\">\n            <ReactMarkdown className=\"document__text text-black\">{body}</ReactMarkdown>\n          </div>\n          <div className=\"document__column information-column text-ssm\">\n            <div\n              className={classNames(\n                'document__status',\n                `document__status_${status}`,\n                'btn',\n                'btn-ssm',\n                'text-ssmd',\n              )}\n            >\n              {status}\n            </div>\n            <DaoInformation className=\"document__information\" title=\"Information\">\n              <DaoProposalInformation\n                ipfs={ipfs}\n                author={author}\n                start={start}\n                end={end}\n                snapshot={snapshot}\n                votingSystem={votingSystem}\n              />\n            </DaoInformation>\n\n            <DaoInformation className=\"document__information\" title=\"Current results\">\n              <SkeletonTwoRows loading={votingPowersLoading}>\n                <DaoProposalVotesResult results={results} />\n              </SkeletonTwoRows>\n            </DaoInformation>\n          </div>\n        </div>\n      </section>\n\n      {status === 'active' && hasConnectedWallet && !hasAlreadyVoted && (\n        <DaoSection className=\"dao__section\" title=\"Cast your vote\">\n          <SkeletonTwoRows loading={votingPowersLoading}>\n            <DaoProposalCastVote\n              proposalId={proposalId}\n              choices={choices}\n              onVote={updateProposalVotes}\n            />\n          </SkeletonTwoRows>\n        </DaoSection>\n      )}\n\n      {status !== 'pending' && (\n        <DaoSection className=\"dao__section\" title=\"Votes\">\n          <SkeletonTenRows loading={votingPowersLoading}>\n            <DaoProposalVotes votes={votes} token={tokens.rp1} />\n          </SkeletonTenRows>\n        </DaoSection>\n      )}\n    </>\n  );\n});\n\nexport default DaoWrapperContent;\n"]},"metadata":{},"sourceType":"module"}