{"ast":null,"code":"var _jsxFileName = \"/Users/rocknblock/Documents/GitHub/strong-hands-frontend/src/components/sections/Trade/RemoveLiquidity/index.tsx\",\n    _s = $RefreshSig$();\n\nimport React from 'react';\nimport { useHistory, useLocation } from 'react-router-dom';\nimport BigNumber from 'bignumber.js/bignumber';\nimport { observer } from 'mobx-react-lite';\nimport UnkNownImg from \"@/assets/img/currency/unknown.svg\";\nimport { Button, Slider } from '@/components/atoms';\nimport { contracts } from '@/config';\nimport { useWalletConnectorContext } from '@/services/MetamaskConnect';\nimport MetamaskService from '@/services/web3';\nimport { useMst } from '@/store';\nimport { clogError } from '@/utils/logger';\nimport { TradeBox } from '..';\nimport './RemoveLiquidity.scss';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst RemoveLiquidity = observer(_c = _s(() => {\n  _s();\n\n  const {\n    user\n  } = useMst();\n  const {\n    metamaskService\n  } = useWalletConnectorContext();\n  const location = useLocation();\n  const history = useHistory();\n  const [percent, setPercent] = React.useState(25);\n  const [liquidityInfo, setLiquidityInfo] = React.useState();\n  const [isTokensApprove, setTokensApprove] = React.useState(false);\n  const [isTokensApproving, setTokensApproving] = React.useState(false);\n  const [lpBalance, setLpBalance] = React.useState('');\n  const btns = [25, 50, 75];\n\n  const handlePercentChange = value => {\n    setPercent(value);\n  };\n\n  const handleCheckApprove = React.useCallback(async () => {\n    try {\n      if (liquidityInfo && user.address) {\n        const balance = await metamaskService.callContractMethodFromNewContract(liquidityInfo === null || liquidityInfo === void 0 ? void 0 : liquidityInfo.address, contracts.PAIR.ABI, 'balanceOf', [user.address]);\n        setLpBalance(balance);\n        const result = await metamaskService.checkTokenAllowance({\n          contractName: 'PAIR',\n          approvedAddress: contracts.ROUTER.ADDRESS,\n          tokenAddress: liquidityInfo === null || liquidityInfo === void 0 ? void 0 : liquidityInfo.address,\n          approveSum: +MetamaskService.amountFromGwei(balance, 18)\n        });\n        setTokensApprove(result);\n      }\n    } catch (err) {\n      clogError('check lp approve', err);\n      setTokensApprove(false);\n    }\n  }, [liquidityInfo, metamaskService, user.address]);\n\n  const handleApprove = async () => {\n    try {\n      if (liquidityInfo && user.address) {\n        setTokensApproving(true);\n        await metamaskService.approveToken({\n          contractName: 'PAIR',\n          approvedAddress: contracts.ROUTER.ADDRESS,\n          tokenAddress: liquidityInfo === null || liquidityInfo === void 0 ? void 0 : liquidityInfo.address\n        });\n        setTokensApproving(false);\n        setTokensApprove(true);\n      }\n    } catch (err) {\n      clogError('approve lp', err);\n      setTokensApproving(false);\n      setTokensApprove(false);\n    }\n  };\n\n  React.useEffect(() => {\n    if (location.state) {\n      setLiquidityInfo(location.state);\n    } else {\n      history.push('/trade/liquidity');\n    }\n  }, [location, history]);\n  React.useEffect(() => {\n    handleCheckApprove();\n  }, [handleCheckApprove]);\n  return /*#__PURE__*/_jsxDEV(TradeBox, {\n    className: \"r-liquidity\",\n    title: \"Remove Liguidity\",\n    titleBackLink: true,\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"r-liquidity__percent text-yellow\",\n      children: [percent, \"%\"]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 99,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Slider, {\n      tooltipVisible: false,\n      onChange: handlePercentChange,\n      defaultValue: 25,\n      value: percent,\n      min: 25\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 100,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"r-liquidity__percent-btns box-f-ai-c box-f-jc-sb\",\n      children: [btns.map(btn => /*#__PURE__*/_jsxDEV(Button, {\n        colorScheme: \"yellow-l\",\n        size: \"smd\",\n        onClick: () => handlePercentChange(btn),\n        children: /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"text-ssmd\",\n          children: [btn, \"%\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 115,\n          columnNumber: 13\n        }, this)\n      }, btn, false, {\n        fileName: _jsxFileName,\n        lineNumber: 109,\n        columnNumber: 11\n      }, this)), /*#__PURE__*/_jsxDEV(Button, {\n        colorScheme: \"yellow-l\",\n        size: \"smd\",\n        onClick: () => handlePercentChange(100),\n        children: /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"text-ssmd\",\n          children: \"Max\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 119,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 118,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 107,\n      columnNumber: 7\n    }, this), liquidityInfo && liquidityInfo.token0.deposited && liquidityInfo.token1.deposited ? /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"r-liquidity__content\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"r-liquidity__currency box-f-ai-c box-f-jc-sb\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"r-liquidity__currency-sum text-lmd\",\n          children: +new BigNumber(MetamaskService.amountFromGwei(liquidityInfo.token0.deposited, +liquidityInfo.token0.decimals)).multipliedBy(percent / 100)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 125,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"box-f-ai-c r-liquidity__currency-item\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"text-smd text-upper\",\n            children: liquidityInfo === null || liquidityInfo === void 0 ? void 0 : liquidityInfo.token0.symbol\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 136,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"img\", {\n            src: UnkNownImg,\n            alt: \"\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 137,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 135,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 124,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"r-liquidity__currency box-f-ai-c box-f-jc-sb\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"r-liquidity__currency-sum text-lmd\",\n          children: +new BigNumber(MetamaskService.amountFromGwei(liquidityInfo.token1.deposited, +liquidityInfo.token1.decimals)).multipliedBy(percent / 100).toFixed(8)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 141,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"box-f-ai-c r-liquidity__currency-item\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"text-smd text-upper\",\n            children: liquidityInfo === null || liquidityInfo === void 0 ? void 0 : liquidityInfo.token1.symbol\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 154,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"img\", {\n            src: UnkNownImg,\n            alt: \"\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 155,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 153,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 140,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 123,\n      columnNumber: 9\n    }, this) : '', (liquidityInfo === null || liquidityInfo === void 0 ? void 0 : liquidityInfo.token1.rate) && (liquidityInfo === null || liquidityInfo === void 0 ? void 0 : liquidityInfo.token0.rate) ? /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"r-liquidity__price box-f box-f-jc-sb text-yellow\",\n      children: [/*#__PURE__*/_jsxDEV(\"span\", {\n        children: \"Price\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 164,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"r-liquidity__price-item text-right\",\n          children: [\"1 \", liquidityInfo === null || liquidityInfo === void 0 ? void 0 : liquidityInfo.token0.symbol, \" = \", +(+(liquidityInfo === null || liquidityInfo === void 0 ? void 0 : liquidityInfo.token1.rate)).toFixed(8), ' ', liquidityInfo === null || liquidityInfo === void 0 ? void 0 : liquidityInfo.token1.symbol]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 166,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"r-liquidity__price-item text-right\",\n          children: [\"1 \", liquidityInfo === null || liquidityInfo === void 0 ? void 0 : liquidityInfo.token1.symbol, \" = \", +(+(liquidityInfo === null || liquidityInfo === void 0 ? void 0 : liquidityInfo.token0.rate)).toFixed(8), ' ', liquidityInfo === null || liquidityInfo === void 0 ? void 0 : liquidityInfo.token0.symbol]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 170,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 165,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 163,\n      columnNumber: 9\n    }, this) : '', /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"r-liquidity__btns box-f-ai-c box-f-jc-e\",\n      children: [!isTokensApprove ? /*#__PURE__*/_jsxDEV(Button, {\n        onClick: handleApprove,\n        loading: isTokensApproving,\n        children: /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"text-white text-bold text-md\",\n          children: \"Approve\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 182,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 181,\n        columnNumber: 11\n      }, this) : /*#__PURE__*/_jsxDEV(\"div\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 185,\n        columnNumber: 11\n      }, this), isTokensApprove && liquidityInfo && liquidityInfo.token0.deposited && liquidityInfo.token1.deposited ? /*#__PURE__*/_jsxDEV(Button, {\n        disabled: !isTokensApprove,\n        link: {\n          pathname: '/trade/liquidity/receive',\n          state: {\n            address: liquidityInfo === null || liquidityInfo === void 0 ? void 0 : liquidityInfo.address,\n            lpTokens: new BigNumber(lpBalance).multipliedBy(new BigNumber(percent).dividedBy(100)).toString(10),\n            token0: { ...(liquidityInfo === null || liquidityInfo === void 0 ? void 0 : liquidityInfo.token0),\n              receive: new BigNumber(liquidityInfo.token0.deposited).multipliedBy(new BigNumber(percent).dividedBy(100)).toString(10)\n            },\n            token1: { ...(liquidityInfo === null || liquidityInfo === void 0 ? void 0 : liquidityInfo.token1),\n              receive: +new BigNumber(liquidityInfo.token1.deposited).multipliedBy(new BigNumber(percent).dividedBy(100)).toString(10)\n            }\n          }\n        },\n        children: /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"text-white text-bold text-md\",\n          children: \"Remove\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 215,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 191,\n        columnNumber: 11\n      }, this) : '']\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 179,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 98,\n    columnNumber: 5\n  }, this);\n}, \"pUK9rg1Vv5TdArhpBu/RbSlN0vk=\", false, function () {\n  return [useMst, useWalletConnectorContext, useLocation, useHistory];\n}));\n_c2 = RemoveLiquidity;\nexport default RemoveLiquidity;\n\nvar _c, _c2;\n\n$RefreshReg$(_c, \"RemoveLiquidity$observer\");\n$RefreshReg$(_c2, \"RemoveLiquidity\");","map":{"version":3,"sources":["/Users/rocknblock/Documents/GitHub/strong-hands-frontend/src/components/sections/Trade/RemoveLiquidity/index.tsx"],"names":["React","useHistory","useLocation","BigNumber","observer","Button","Slider","contracts","useWalletConnectorContext","MetamaskService","useMst","clogError","TradeBox","RemoveLiquidity","user","metamaskService","location","history","percent","setPercent","useState","liquidityInfo","setLiquidityInfo","isTokensApprove","setTokensApprove","isTokensApproving","setTokensApproving","lpBalance","setLpBalance","btns","handlePercentChange","value","handleCheckApprove","useCallback","address","balance","callContractMethodFromNewContract","PAIR","ABI","result","checkTokenAllowance","contractName","approvedAddress","ROUTER","ADDRESS","tokenAddress","approveSum","amountFromGwei","err","handleApprove","approveToken","useEffect","state","push","map","btn","token0","deposited","token1","decimals","multipliedBy","symbol","UnkNownImg","toFixed","rate","pathname","lpTokens","dividedBy","toString","receive"],"mappings":"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","sourcesContent":["import React from 'react';\nimport { useHistory, useLocation } from 'react-router-dom';\nimport BigNumber from 'bignumber.js/bignumber';\nimport { observer } from 'mobx-react-lite';\n\nimport UnkNownImg from '@/assets/img/currency/unknown.svg';\nimport { Button, Slider } from '@/components/atoms';\nimport { contracts } from '@/config';\nimport { useWalletConnectorContext } from '@/services/MetamaskConnect';\nimport MetamaskService from '@/services/web3';\nimport { useMst } from '@/store';\nimport { ILiquidityInfo } from '@/types';\nimport { clogError } from '@/utils/logger';\n\nimport { TradeBox } from '..';\n\nimport './RemoveLiquidity.scss';\n\nconst RemoveLiquidity: React.FC = observer(() => {\n  const { user } = useMst();\n  const { metamaskService } = useWalletConnectorContext();\n\n  const location = useLocation<ILiquidityInfo>();\n  const history = useHistory();\n  const [percent, setPercent] = React.useState<number>(25);\n\n  const [liquidityInfo, setLiquidityInfo] = React.useState<ILiquidityInfo>();\n  const [isTokensApprove, setTokensApprove] = React.useState<boolean>(false);\n  const [isTokensApproving, setTokensApproving] = React.useState<boolean>(false);\n  const [lpBalance, setLpBalance] = React.useState<string>('');\n\n  const btns = [25, 50, 75];\n\n  const handlePercentChange = (value: number) => {\n    setPercent(value);\n  };\n\n  const handleCheckApprove = React.useCallback(async () => {\n    try {\n      if (liquidityInfo && user.address) {\n        const balance = await metamaskService.callContractMethodFromNewContract(\n          liquidityInfo?.address,\n          contracts.PAIR.ABI,\n          'balanceOf',\n          [user.address],\n        );\n\n        setLpBalance(balance);\n\n        const result = await metamaskService.checkTokenAllowance({\n          contractName: 'PAIR',\n          approvedAddress: contracts.ROUTER.ADDRESS,\n          tokenAddress: liquidityInfo?.address,\n          approveSum: +MetamaskService.amountFromGwei(balance, 18),\n        });\n\n        setTokensApprove(result);\n      }\n    } catch (err) {\n      clogError('check lp approve', err);\n      setTokensApprove(false);\n    }\n  }, [liquidityInfo, metamaskService, user.address]);\n\n  const handleApprove = async () => {\n    try {\n      if (liquidityInfo && user.address) {\n        setTokensApproving(true);\n        await metamaskService.approveToken({\n          contractName: 'PAIR',\n          approvedAddress: contracts.ROUTER.ADDRESS,\n          tokenAddress: liquidityInfo?.address,\n        });\n\n        setTokensApproving(false);\n        setTokensApprove(true);\n      }\n    } catch (err) {\n      clogError('approve lp', err);\n      setTokensApproving(false);\n      setTokensApprove(false);\n    }\n  };\n\n  React.useEffect(() => {\n    if (location.state) {\n      setLiquidityInfo(location.state);\n    } else {\n      history.push('/trade/liquidity');\n    }\n  }, [location, history]);\n\n  React.useEffect(() => {\n    handleCheckApprove();\n  }, [handleCheckApprove]);\n\n  return (\n    <TradeBox className=\"r-liquidity\" title=\"Remove Liguidity\" titleBackLink>\n      <div className=\"r-liquidity__percent text-yellow\">{percent}%</div>\n      <Slider\n        tooltipVisible={false}\n        onChange={handlePercentChange}\n        defaultValue={25}\n        value={percent}\n        min={25}\n      />\n      <div className=\"r-liquidity__percent-btns box-f-ai-c box-f-jc-sb\">\n        {btns.map((btn) => (\n          <Button\n            colorScheme=\"yellow-l\"\n            size=\"smd\"\n            key={btn}\n            onClick={() => handlePercentChange(btn)}\n          >\n            <span className=\"text-ssmd\">{btn}%</span>\n          </Button>\n        ))}\n        <Button colorScheme=\"yellow-l\" size=\"smd\" onClick={() => handlePercentChange(100)}>\n          <span className=\"text-ssmd\">Max</span>\n        </Button>\n      </div>\n      {liquidityInfo && liquidityInfo.token0.deposited && liquidityInfo.token1.deposited ? (\n        <div className=\"r-liquidity__content\">\n          <div className=\"r-liquidity__currency box-f-ai-c box-f-jc-sb\">\n            <div className=\"r-liquidity__currency-sum text-lmd\">\n              {\n                +new BigNumber(\n                  MetamaskService.amountFromGwei(\n                    liquidityInfo.token0.deposited,\n                    +liquidityInfo.token0.decimals,\n                  ),\n                ).multipliedBy(percent / 100)\n              }\n            </div>\n            <div className=\"box-f-ai-c r-liquidity__currency-item\">\n              <div className=\"text-smd text-upper\">{liquidityInfo?.token0.symbol}</div>\n              <img src={UnkNownImg} alt=\"\" />\n            </div>\n          </div>\n          <div className=\"r-liquidity__currency box-f-ai-c box-f-jc-sb\">\n            <div className=\"r-liquidity__currency-sum text-lmd\">\n              {\n                +new BigNumber(\n                  MetamaskService.amountFromGwei(\n                    liquidityInfo.token1.deposited,\n                    +liquidityInfo.token1.decimals,\n                  ),\n                )\n                  .multipliedBy(percent / 100)\n                  .toFixed(8)\n              }\n            </div>\n            <div className=\"box-f-ai-c r-liquidity__currency-item\">\n              <div className=\"text-smd text-upper\">{liquidityInfo?.token1.symbol}</div>\n              <img src={UnkNownImg} alt=\"\" />\n            </div>\n          </div>\n        </div>\n      ) : (\n        ''\n      )}\n      {liquidityInfo?.token1.rate && liquidityInfo?.token0.rate ? (\n        <div className=\"r-liquidity__price box-f box-f-jc-sb text-yellow\">\n          <span>Price</span>\n          <div>\n            <div className=\"r-liquidity__price-item text-right\">\n              1 {liquidityInfo?.token0.symbol} = {+(+liquidityInfo?.token1.rate).toFixed(8)}{' '}\n              {liquidityInfo?.token1.symbol}\n            </div>\n            <div className=\"r-liquidity__price-item text-right\">\n              1 {liquidityInfo?.token1.symbol} = {+(+liquidityInfo?.token0.rate).toFixed(8)}{' '}\n              {liquidityInfo?.token0.symbol}\n            </div>\n          </div>\n        </div>\n      ) : (\n        ''\n      )}\n      <div className=\"r-liquidity__btns box-f-ai-c box-f-jc-e\">\n        {!isTokensApprove ? (\n          <Button onClick={handleApprove} loading={isTokensApproving}>\n            <span className=\"text-white text-bold text-md\">Approve</span>\n          </Button>\n        ) : (\n          <div />\n        )}\n        {isTokensApprove &&\n        liquidityInfo &&\n        liquidityInfo.token0.deposited &&\n        liquidityInfo.token1.deposited ? (\n          <Button\n            disabled={!isTokensApprove}\n            link={{\n              pathname: '/trade/liquidity/receive',\n              state: {\n                address: liquidityInfo?.address,\n                lpTokens: new BigNumber(lpBalance)\n                  .multipliedBy(new BigNumber(percent).dividedBy(100))\n                  .toString(10),\n                token0: {\n                  ...liquidityInfo?.token0,\n                  receive: new BigNumber(liquidityInfo.token0.deposited)\n                    .multipliedBy(new BigNumber(percent).dividedBy(100))\n                    .toString(10),\n                },\n                token1: {\n                  ...liquidityInfo?.token1,\n                  receive: +new BigNumber(liquidityInfo.token1.deposited)\n                    .multipliedBy(new BigNumber(percent).dividedBy(100))\n                    .toString(10),\n                },\n              },\n            }}\n          >\n            <span className=\"text-white text-bold text-md\">Remove</span>\n          </Button>\n        ) : (\n          ''\n        )}\n      </div>\n    </TradeBox>\n  );\n});\n\nexport default RemoveLiquidity;\n"]},"metadata":{},"sourceType":"module"}